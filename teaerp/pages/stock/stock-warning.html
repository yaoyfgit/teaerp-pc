<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>库存预警 - TeaERP</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/layout.css">
    <link rel="stylesheet" href="../../css/menu.css">
    <link rel="stylesheet" href="../../css/modules/stock.css">
</head>
<body>
    <div class="app-container">
        <div class="sidebar">
            <div class="main-menu"></div>
        </div>
        <div class="main-content">
            <div class="top-navbar">
                <div class="toggle-menu">
                    <i class="fas fa-bars"></i>
                </div>
                <div class="logo">TeaERP</div>
                <nav class="top-nav">
                    <ul>
                        <li><a href="../../index.html">首页</a></li>
                        <li><a href="#">消息</a></li>
                        <li><a href="#">帮助</a></li>
                    </ul>
                </nav>
                <div class="user-info">
                    <span class="username">管理员</span>
                    <a href="#" class="logout">退出</a>
                </div>
            </div>

            <div class="content">
                <div class="breadcrumb">
                    <i class="fas fa-home"></i>
                    <span>首页</span>
                    <i class="fas fa-angle-right separator"></i>
                    <i class="fas fa-warehouse"></i>
                    <span>库存管理</span>
                    <i class="fas fa-angle-right separator"></i>
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>库存预警</span>
                </div>

                <!-- 预警统计 -->
                <div class="standard-card">
                    <div class="overview-grid">
                        <div class="overview-item warning">
                            <i class="fas fa-exclamation-triangle"></i>
                            <div class="info">
                                <h4>预警商品</h4>
                                <div class="number">12<span class="unit">种</span></div>
                            </div>
                        </div>
                        <div class="overview-item danger">
                            <i class="fas fa-times-circle"></i>
                            <div class="info">
                                <h4>缺货商品</h4>
                                <div class="number">5<span class="unit">种</span></div>
                            </div>
                        </div>
                        <div class="overview-item warning">
                            <i class="fas fa-layer-group"></i>
                            <div class="info">
                                <h4>积压商品</h4>
                                <div class="number">8<span class="unit">种</span></div>
                            </div>
                        </div>
                        <div class="overview-item success">
                            <i class="fas fa-calendar-check"></i>
                            <div class="info">
                                <h4>已处理</h4>
                                <div class="number">15<span class="unit">种</span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 预警列表 -->
                <div class="standard-card">
                    <div class="standard-card-header">
                        <h3><i class="fas fa-list"></i> 预警明细</h3>
                        <div class="action-bar">
                            <div class="search-group">
                                <input type="text" class="standard-input" placeholder="商品编码/名称">
                                <select class="standard-select">
                                    <option value="">所有分类</option>
                                    <option value="1">乌龙茶</option>
                                    <option value="2">绿茶</option>
                                    <option value="3">红茶</option>
                                    <option value="4">黑茶</option>
                                </select>
                                <select class="standard-select">
                                    <option value="">所有仓库</option>
                                    <option value="1">主仓库</option>
                                    <option value="2">次仓库</option>
                                </select>
                                <select class="standard-select">
                                    <option value="">预警类型</option>
                                    <option value="warning">库存预警</option>
                                    <option value="stockout">缺货预警</option>
                                    <option value="overstock">积压预警</option>
                                </select>
                            </div>
                            <div class="button-group">
                                <button class="standard-button primary" onclick="searchWarning()">
                                    <i class="fas fa-search"></i> 查询
                                </button>
                                <button class="standard-button" onclick="exportWarning()">
                                    <i class="fas fa-file-export"></i> 导出
                                </button>
                                <button class="standard-button" onclick="batchProcess()">
                                    <i class="fas fa-check"></i> 批量处理
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="standard-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>
                                        <input type="checkbox" class="standard-checkbox" onclick="toggleSelectAll(this)">
                                    </th>
                                    <th>商品编码</th>
                                    <th>商品名称</th>
                                    <th>商品分类</th>
                                    <th>规格型号</th>
                                    <th>所属仓库</th>
                                    <th>当前库存</th>
                                    <th>预警值</th>
                                    <th>预警类型</th>
                                    <th>预警时间</th>
                                    <th>处理状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="warningTable">
                                <!-- 示例数据 -->
                                <tr>
                                    <td><input type="checkbox" class="standard-checkbox"></td>
                                    <td>P001</td>
                                    <td>特级铁观音</td>
                                    <td>乌龙茶</td>
                                    <td>250g/盒</td>
                                    <td>主仓库</td>
                                    <td>10</td>
                                    <td>20</td>
                                    <td><span class="status-tag warning">库存预警</span></td>
                                    <td>2024-03-20 14:30:00</td>
                                    <td><span class="status-tag">未处理</span></td>
                                    <td>
                                        <button class="operation-button" onclick="viewWarning('P001')">
                                            <i class="fas fa-eye"></i> 查看
                                        </button>
                                        <button class="operation-button" onclick="processWarning('P001')">
                                            <i class="fas fa-check"></i> 处理
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><input type="checkbox" class="standard-checkbox"></td>
                                    <td>P002</td>
                                    <td>明前龙井</td>
                                    <td>绿茶</td>
                                    <td>200g/罐</td>
                                    <td>主仓库</td>
                                    <td>0</td>
                                    <td>15</td>
                                    <td><span class="status-tag danger">缺货预警</span></td>
                                    <td>2024-03-20 15:00:00</td>
                                    <td><span class="status-tag">未处理</span></td>
                                    <td>
                                        <button class="operation-button" onclick="viewWarning('P002')">
                                            <i class="fas fa-eye"></i> 查看
                                        </button>
                                        <button class="operation-button" onclick="processWarning('P002')">
                                            <i class="fas fa-check"></i> 处理
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td><input type="checkbox" class="standard-checkbox"></td>
                                    <td>P003</td>
                                    <td>大红袍</td>
                                    <td>乌龙茶</td>
                                    <td>100g/盒</td>
                                    <td>次仓库</td>
                                    <td>200</td>
                                    <td>150</td>
                                    <td><span class="status-tag warning">积压预警</span></td>
                                    <td>2024-03-20 16:15:00</td>
                                    <td><span class="status-tag success">已处理</span></td>
                                    <td>
                                        <button class="operation-button" onclick="viewWarning('P003')">
                                            <i class="fas fa-eye"></i> 查看
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="standard-pagination" id="pagination"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 处理预警弹窗 -->
    <div class="standard-modal" id="processModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-check-circle"></i> 处理预警</h3>
                <button class="standard-close-btn" onclick="hideModal('processModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="processForm" class="standard-form">
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label>处理方式</label>
                                <select class="standard-select" name="processType" required>
                                    <option value="">请选择处理方式</option>
                                    <option value="1">采购补货</option>
                                    <option value="2">调拨补货</option>
                                    <option value="3">促销处理</option>
                                    <option value="4">其他</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label>处理说明</label>
                                <textarea class="standard-input" name="remark" rows="3" required></textarea>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <div class="button-group">
                    <button class="standard-button" onclick="hideModal('processModal')">
                        <i class="fas fa-times"></i> 取消
                    </button>
                    <button class="standard-button primary" onclick="submitProcess()">
                        <i class="fas fa-check"></i> 确认
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 查看预警弹窗 -->
    <div class="standard-modal" id="viewModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-eye"></i> 查看预警</h3>
                <button class="standard-close-btn" onclick="hideModal('viewModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="view-info view-grid">
                    <div class="view-row">
                        <div class="view-col">
                    <p><strong>商品编码：</strong><span id="viewCode"></span></p>
                    <p><strong>商品名称：</strong><span id="viewName"></span></p>
                        </div>
                        <div class="view-col">
                    <p><strong>商品分类：</strong><span id="viewCategory"></span></p>
                    <p><strong>规格型号：</strong><span id="viewSpec"></span></p>
                        </div>
                    </div>
                    <div class="view-row">
                        <div class="view-col">
                    <p><strong>所属仓库：</strong><span id="viewWarehouse"></span></p>
                    <p><strong>当前库存：</strong><span id="viewStock"></span></p>
                        </div>
                        <div class="view-col">
                    <p><strong>预警值：</strong><span id="viewWarningValue"></span></p>
                    <p><strong>预警类型：</strong><span id="viewWarningType"></span></p>
                        </div>
                    </div>
                    <div class="view-row">
                        <div class="view-col">
                    <p><strong>预警时间：</strong><span id="viewWarningTime"></span></p>
                        </div>
                        <div class="view-col">
                    <p><strong>处理状态：</strong><span id="viewStatus"></span></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="button-group">
                    <button class="standard-button" onclick="hideModal('viewModal')">
                        <i class="fas fa-times"></i> 关闭
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="../../js/app.js"></script>
    <script>
        // 显示弹窗
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        // 隐藏弹窗
        function hideModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // 查看预警
        function viewWarning(code) {
            // 模拟获取预警数据
            const mockData = {
                code: code,
                name: '特级铁观音',
                category: '乌龙茶',
                spec: '250g/盒',
                warehouse: '主仓库',
                stock: 10,
                warningValue: 20,
                warningType: '库存预警',
                warningTime: '2024-03-20 14:30:00',
                status: '未处理'
            };

            // 填充数据
            document.getElementById('viewCode').textContent = mockData.code;
            document.getElementById('viewName').textContent = mockData.name;
            document.getElementById('viewCategory').textContent = mockData.category;
            document.getElementById('viewSpec').textContent = mockData.spec;
            document.getElementById('viewWarehouse').textContent = mockData.warehouse;
            document.getElementById('viewStock').textContent = mockData.stock;
            document.getElementById('viewWarningValue').textContent = mockData.warningValue;
            document.getElementById('viewWarningType').textContent = mockData.warningType;
            document.getElementById('viewWarningTime').textContent = mockData.warningTime;
            document.getElementById('viewStatus').textContent = mockData.status;

            showModal('viewModal');
        }

        // 处理预警
        function processWarning(code) {
            showModal('processModal');
        }

        // 提交处理
        function submitProcess() {
            const form = document.getElementById('processForm');
            if (!form.processType.value) {
                alert('请选择处理方式');
                return;
            }
            if (!form.remark.value) {
                alert('请输入处理说明');
                return;
            }

            // TODO: 发送处理请求
            alert('处理成功');
            hideModal('processModal');
            // 刷新列表
            location.reload();
        }
    </script>

    <style>
        .overview-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            background: #fff;
            border-radius: 4px;
            box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);
            border-left: 4px solid #409eff;
        }

        .overview-item i {
            font-size: 24px;
            color: #409eff;
        }

        .overview-item .number {
            color: #409eff;
            font-weight: bold;
        }

        .overview-item.warning {
            border-left-color: #e6a23c;
        }

        .overview-item.warning i,
        .overview-item.warning .number {
            color: #e6a23c;
        }

        .overview-item.danger {
            border-left-color: #f56c6c;
        }

        .overview-item.danger i,
        .overview-item.danger .number {
            color: #f56c6c;
        }

        .overview-item.success {
            border-left-color: #67c23a;
            background-color: #f0f9eb;
        }

        .overview-item.success i,
        .overview-item.success .number {
            color: #67c23a;
        }

        .standard-table .operation-button {
            padding: 4px 8px;
            margin: 0 4px;
            color: #409eff;
            background: none;
            border: none;
            cursor: pointer;
        }

        .standard-table .operation-button:hover {
            color: #66b1ff;
        }

        .view-info {
            padding: 20px;
            background: #f5f7fa;
            border-radius: 4px;
        }

        .view-grid {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .view-row {
            display: flex;
            gap: 40px;
        }

        .view-col {
            flex: 1;
        }

        .view-info p {
            margin: 10px 0;
            color: #606266;
        }

        .view-info strong {
            display: inline-block;
            width: 100px;
        }

        #processModal .modal-content {
            width: 600px;
        }

        #processModal .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        #processModal .form-col {
            flex: 1;
        }

        .status-tag {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            background: #909399;
            color: #fff;
        }

        .status-tag.warning {
            background: #e6a23c;
        }

        .status-tag.danger {
            background: #f56c6c;
        }

        .status-tag.success {
            background: #67c23a;
        }
    </style>
</body>
</html> 